{% extends "base.html" %}
{% block title %}案件一覧{% endblock %}

{% block content %}
<div class="page-header">
  <h1>案件一覧</h1>
  {% if request.user.is_staff or request.user.is_superuser %}
  <a href="{% url 'case_create' %}" class="btn btn-primary">＋ 新規案件</a>
  {% endif %}
</div>

<div class="card">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>ユニークキー</th>
        <th>案件名</th>
        <th>説明</th>
        <th>ステータス</th>
        <th>作成者</th>
        <th>作成日時</th>
        {% if request.user.is_staff or request.user.is_superuser %}
        <th>操作</th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      {% for c in cases %}
      <tr>
        <td style="color:#94a3b8">{{ c.id }}</td>
        <td>
          <code style="background:#f1f5f9; padding:3px 8px; border-radius:6px; font-size:.9rem; letter-spacing:.05em">{{ c.unique_key }}</code>
        </td>
        <td><strong>{{ c.name }}</strong></td>
        <td style="color:#64748b; max-width:280px">{{ c.description|truncatechars:60 }}</td>
        <td>
          {% if c.is_active %}
          <span class="tag tag-active">有効</span>
          {% else %}
          <span class="tag tag-inactive">無効</span>
          {% endif %}
        </td>
        <td>{{ c.created_by.username }}</td>
        <td style="color:#94a3b8; font-size:.85rem">{{ c.created_at|date:"Y/m/d H:i" }}</td>
        {% if request.user.is_staff or request.user.is_superuser %}
        <td>
          <a href="{% url 'case_edit' c.pk %}" class="btn btn-secondary btn-sm">編集</a>
          <a href="{% url 'case_delete' c.pk %}" class="btn btn-danger btn-sm">削除</a>
        </td>
        {% endif %}
      </tr>
      {% empty %}
      <tr>
        <td colspan="7" style="text-align:center; color:#94a3b8; padding:2rem">案件がまだ登録されていません</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
