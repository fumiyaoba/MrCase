{% extends "base.html" %}
{% block title %}ユーザー編集{% endblock %}

{% block content %}
<div class="page-header">
  <h1>ユーザー編集</h1>
  <a href="{% url 'user_list' %}" class="btn btn-secondary">← 一覧へ戻る</a>
</div>

<div class="card" style="max-width:560px">
  <form method="post">
    {% csrf_token %}
    {% if form.errors %}
    <div class="alert alert-danger">
      {% for field in form %}{% for error in field.errors %}{{ error }}<br>{% endfor %}{% endfor %}
      {% for error in form.non_field_errors %}{{ error }}<br>{% endfor %}
    </div>
    {% endif %}
    <div class="form-group">
      <label for="id_username">ユーザー名 <span style="color:#ef4444">*</span></label>
      <input type="text" name="username" id="id_username" value="{{ form.username.value|default_if_none:'' }}" required>
    </div>
    <div style="display:flex; gap:1rem">
      <div class="form-group" style="flex:1">
        <label for="id_last_name">姓</label>
        <input type="text" name="last_name" id="id_last_name" value="{{ form.last_name.value|default_if_none:'' }}">
      </div>
      <div class="form-group" style="flex:1">
        <label for="id_first_name">名</label>
        <input type="text" name="first_name" id="id_first_name" value="{{ form.first_name.value|default_if_none:'' }}">
      </div>
    </div>
    <div class="form-group">
      <label for="id_password">新しいパスワード（変更しない場合は空欄）</label>
      <input type="password" name="password" id="id_password">
    </div>
    <div class="form-group">
      <label for="id_password_confirm">新しいパスワード（確認）</label>
      <input type="password" name="password_confirm" id="id_password_confirm">
    </div>
    <div class="form-group">
      <div class="form-check">
        <input type="checkbox" name="is_staff" id="id_is_staff" {% if form.is_staff.value %}checked{% endif %}>
        <label for="id_is_staff" style="margin-bottom:0">管理者にする</label>
      </div>
    </div>
    <div style="display:flex; gap:.75rem; margin-top:1.5rem">
      <button type="submit" class="btn btn-primary">更新する</button>
      <a href="{% url 'user_list' %}" class="btn btn-secondary">キャンセル</a>
    </div>
  </form>
</div>
{% endblock %}
